(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-89f504ec"],{"560d":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("breadcrumb",{attrs:{sperator:"/",breadcrumbItemList:["用户管理","用户列表"]}}),a("el-card",{attrs:{shadow:"always"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容",clearable:!0},on:{clear:function(t){return e.getUsersData(e.usersQuery)}},model:{value:e.usersQuery.query,callback:function(t){e.$set(e.usersQuery,"query",t)},expression:"usersQuery.query"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(t){return e.getUsersData(e.usersQuery)}},slot:"append"})],1)],1),a("el-col",{attrs:{span:6}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addDialogVisible=!0}}},[e._v("添加用户")])],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.users,stripe:""}},[a("el-table-column",{attrs:{type:"index",label:"#",width:"180"}}),a("el-table-column",{attrs:{prop:"username",label:"姓名",width:"180"}}),a("el-table-column",{attrs:{prop:"email",label:"邮箱",width:"180"}}),a("el-table-column",{attrs:{prop:"mobile",label:"电话"}}),a("el-table-column",{attrs:{prop:"role_name",label:"角色"}}),a("el-table-column",{attrs:{prop:"mg_state",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(a){return e.changeUserState(t.row)}},model:{value:t.row.mg_state,callback:function(a){e.$set(t.row,"mg_state",a)},expression:"slotScope.row.mg_state"}})]}}])}),a("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(a){return e.showUpdateUserDialog(t.row)}}}),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(a){return e.openDeleteComfirm(t.row)}}}),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"设置",placement:"top",enterable:!1}},[a("el-button",{attrs:{type:"warning",icon:"el-icon-setting",size:"mini"},on:{click:function(a){return e.showDispatchDialog(t.row)}}})],1)]}}])})],1),a("el-pagination",{attrs:{"current-page":e.usersQuery.pagenum,"page-sizes":[1,2,5,10],"page-size":e.usersQuery.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("el-dialog",{attrs:{title:"添加用户",visible:e.addDialogVisible,width:"50%"},on:{"update:visible":function(t){e.addDialogVisible=t},closed:e.closeDialog}},[a("el-form",{ref:"addFormQueryRef",attrs:{model:e.addFormQuery,rules:e.addFormQueryRules,"label-width":"120px"}},[a("el-form-item",{staticClass:"input-width",attrs:{label:"用户名",prop:"username"}},[a("el-input",{model:{value:e.addFormQuery.username,callback:function(t){e.$set(e.addFormQuery,"username",t)},expression:"addFormQuery.username"}})],1),a("el-form-item",{staticClass:"input-width",attrs:{label:"密码",prop:"password"}},[a("el-input",{model:{value:e.addFormQuery.password,callback:function(t){e.$set(e.addFormQuery,"password",t)},expression:"addFormQuery.password"}})],1),a("el-form-item",{staticClass:"input-width",attrs:{label:"邮箱",prop:"email"}},[a("el-input",{model:{value:e.addFormQuery.email,callback:function(t){e.$set(e.addFormQuery,"email",t)},expression:"addFormQuery.email"}})],1),a("el-form-item",{staticClass:"input-width",attrs:{label:"手机",prop:"mobile"}},[a("el-input",{model:{value:e.addFormQuery.mobile,callback:function(t){e.$set(e.addFormQuery,"mobile",t)},expression:"addFormQuery.mobile"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.addUser}},[e._v("确 定")])],1)],1),a("el-dialog",{ref:"updateUserDialogRef",attrs:{title:"修改用户",visible:e.updateDialogVisible,width:"50%"},on:{"update:visible":function(t){e.updateDialogVisible=t},closed:e.closeUpdateUserDialog}},[a("el-form",{ref:"updateUserFormQueryRef",attrs:{model:e.editForm,"label-width":"120px"}},[a("el-form-item",{staticClass:"input-width",attrs:{label:"用户名",prop:"username"}},[a("el-input",{attrs:{disabled:""},model:{value:e.editForm.username,callback:function(t){e.$set(e.editForm,"username",t)},expression:"editForm.username"}})],1),a("el-form-item",{staticClass:"input-width",attrs:{label:"邮箱",prop:"email"}},[a("el-input",{model:{value:e.editForm.email,callback:function(t){e.$set(e.editForm,"email",t)},expression:"editForm.email"}})],1),a("el-form-item",{staticClass:"input-width",attrs:{label:"手机",prop:"mobile"}},[a("el-input",{model:{value:e.editForm.mobile,callback:function(t){e.$set(e.editForm,"mobile",t)},expression:"editForm.mobile"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.updateDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.updateUser}},[e._v("确 定")])],1)],1),a("popup",{attrs:{title:"分配角色",dialogVisible:e.dispatchRightDialogVisible,width:"45%"},on:{handleClose:e.handleClosePopup,save:e.saveRoleRight,cancel:e.cancelDialog}},[a("div",[a("p",[e._v("当前的用户:"+e._s(e.userInfo.username))]),a("p",[e._v("当前角色:"+e._s(e.userInfo.role_name))]),a("el-select",{attrs:{placeholder:"请选择角色"},model:{value:e.currentRight,callback:function(t){e.currentRight=t},expression:"currentRight"}},e._l(e.rightList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.roleName,value:e.id}})})),1)],1)])],1)},s=[],i=(a("e25e"),a("a049")),o=a("c22e"),n=(a("99af"),a("1bab"));function l(e){return Object(n["a"])({url:"users",method:"get",params:{query:e.query,pagenum:e.pagenum,pagesize:e.pagesize}})}function u(e){return Object(n["a"])({url:"users/".concat(e.uId,"/state/").concat(e.type),method:"put"})}function c(e){return Object(n["a"])({url:"users",method:"post",data:{username:e.username,password:e.password,email:e.email,mobile:e.mobile}})}function d(e){return Object(n["a"])({url:"users/".concat(e.id),method:"get"})}function m(e){return Object(n["a"])({url:"users/".concat(e.id),method:"put",data:{id:e.id,email:e.email,mobile:e.mobile}})}function p(e){return Object(n["a"])({url:"users/".concat(e.id),method:"delete"})}function f(){return Object(n["a"])({url:"roles",method:"get"})}function g(e,t){return Object(n["a"])({url:"users/".concat(e,"/role"),method:"put",data:{id:e,rid:t}})}var h=function(e,t,a){var r=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;r.test(t)?a():a(new Error("请输入正确的邮箱"))},b=function(e,t,a){var r=/^(?:(?:\+|00)86)?1[3-9]\d{9}$/;r.test(t)?a():a(new Error("请输入正确的手机号"))},y={name:"UserList",data:function(){return{usersQuery:{query:"",pagenum:1,pagesize:5},userStateQuery:{uId:"",type:""},addFormQuery:{username:"admin",password:"12345",email:"2@qq.com",mobile:"18758580112"},addFormQueryRules:{username:[{required:!0,message:"请输入用户名称",trigger:"blur"},{min:3,max:5,message:"长度在 3 到 5 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:3,max:5,message:"长度在 3 到 5 个字符",trigger:"blur"}],email:[{validator:h,trigger:"blur"}],mobile:[{validator:b,trigger:"blur"}]},queryUser:{id:0},editForm:{},users:[],total:0,addDialogVisible:!1,updateDialogVisible:!1,dispatchRightDialogVisible:!1,userInfo:{},rightList:[],currentRight:""}},created:function(){this.getUsersData(this.usersQuery)},methods:{getUsersData:function(e){var t=this;l(e).then((function(e){t.users=e.data.users,t.total=e.data.total}))},changeUserState:function(e){var t=this;this.userStateQuery.uId=e.id,this.userStateQuery.type=e.mg_state,u(this.userStateQuery).then((function(e){200===e.meta.status?t.$message.success("修改成功"):function(){t.$message.error("修改失败"),t.userStateQuery.type=!t.userStateQuery.type}()}))},addUser:function(){var e=this;this.$refs.addFormQueryRef.validate((function(t){t&&function(){c(e.addFormQuery).then((function(t){201!==t.meta.status?e.$message.error(t.meta.msg):function(){e.$message.success(t.meta.msg),e.addDialogVisible=!1,e.usersQuery.pagenum=1,e.getUsersData(e.usersQuery)}()}))}()}))},updateUser:function(){var e=this;m(this.editForm).then((function(t){200!==t.meta.status?e.$message.error(t.meta.msg):function(){e.$message.success(t.meta.msg),e.updateDialogVisible=!1,e.getUsersData(e.usersQuery)}()}))},handleSizeChange:function(e){this.usersQuery.pagesize=e,this.getUsersData(this.usersQuery)},handleCurrentChange:function(e){this.usersQuery.pagenum=e,this.getUsersData(this.usersQuery)},closeDialog:function(){this.$refs.addFormQueryRef.resetFields()},closeUpdateUserDialog:function(){this.$refs.updateUserFormQueryRef.resetFields()},showUpdateUserDialog:function(e){var t=this;this.updateDialogVisible=!0,this.queryUser.id=parseInt(e.id),d(this.queryUser).then((function(e){t.editForm=e.data}))},openDeleteComfirm:function(e){var t=this;this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){p(e).then((function(e){200===e.meta.status?function(){t.$message.success(e.meta.msg),t.usersQuery.pagenum=1,t.getUsersData(t.usersQuery)}():t.$message.error(e.meta.msg)}))}))["catch"]((function(){t.$message({type:"info",message:"已取消删除"})}))},showDispatchDialog:function(e){var t=this;this.userInfo=e,f().then((function(e){200===e.meta.status?function(){t.rightList=e.data}():t.$message.error(e.meta.msg)})),this.dispatchRightDialogVisible=!0},saveRoleRight:function(){var e=this;g(this.userInfo.id,this.currentRight).then((function(t){200===t.meta.status?function(){e.dispatchRightDialogVisible=!1,e.getUsersData(e.usersQuery)}():e.$message.error(t.meta.msg)}))},handleClosePopup:function(){this.dispatchRightDialogVisible=!1,this.currentRight=""},cancelDialog:function(){this.dispatchRightDialogVisible=!1}},components:{Breadcrumb:i["a"],Popup:o["a"]}},v=y,w=(a("6e32"),a("2877")),Q=Object(w["a"])(v,r,s,!1,null,"4dc07074",null);t["default"]=Q.exports},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,a){var r=a("1d80"),s=a("5899"),i="["+s+"]",o=RegExp("^"+i+i+"*"),n=RegExp(i+i+"*$"),l=function(e){return function(t){var a=String(r(t));return 1&e&&(a=a.replace(o,"")),2&e&&(a=a.replace(n,"")),a}};e.exports={start:l(1),end:l(2),trim:l(3)}},"6e2f":function(e,t,a){},"6e32":function(e,t,a){"use strict";a("6e2f")},a049:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-breadcrumb",{attrs:{separator:e.separator}},e._l(e.breadcrumbItemList,(function(t,r){return a("el-breadcrumb-item",{key:r},[e._v(e._s(t))])})),1)},s=[],i={name:"Breadcrumb",props:{breadcrumbItemList:{type:Array,default:function(){return[]}},separator:{type:String,default:"/"}}},o=i,n=a("2877"),l=Object(n["a"])(o,r,s,!1,null,"13c0996c",null);t["a"]=l.exports},c20d:function(e,t,a){var r=a("da84"),s=a("58a8").trim,i=a("5899"),o=r.parseInt,n=/^[+-]?0[Xx]/,l=8!==o(i+"08")||22!==o(i+"0x16");e.exports=l?function(e,t){var a=s(String(e));return o(a,t>>>0||(n.test(a)?16:10))}:o},c22e:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.title,visible:e.dialogVisible,width:e.width,"before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close}},[e._t("default",[a("p",[e._v("自定义弹框内容")])]),e.isButtonGroupShow?a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确 定")])],1):e._e()],2)},s=[],i={name:"Popup",props:{title:{type:String,default:"标题"},width:{type:String,default:"30%"},dialogVisible:{type:Boolean,default:!1},isButtonGroupShow:{type:Boolean,default:!0}},methods:{handleClose:function(){this.$emit("handleClose")},close:function(){this.$emit("close")},save:function(){this.$emit("save")}}},o=i,n=a("2877"),l=Object(n["a"])(o,r,s,!1,null,"6ca987d4",null);t["a"]=l.exports},e25e:function(e,t,a){var r=a("23e7"),s=a("c20d");r({global:!0,forced:parseInt!=s},{parseInt:s})}}]);
//# sourceMappingURL=chunk-89f504ec.a4f01f2d.js.map