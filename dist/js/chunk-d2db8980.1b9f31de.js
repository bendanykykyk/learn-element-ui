(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d2db8980"],{"0773":function(t,e,i){},"2cb2":function(t,e,i){"use strict";i("0773")},c22e:function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{title:t.title,visible:t.dialogVisible,width:t.width,"before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e},close:t.close}},[t._t("default",[i("p",[t._v("自定义弹框内容")])]),t.isButtonGroupShow?i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.handleClose}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("确 定")])],1):t._e()],2)},o=[],n={name:"Popup",props:{title:{type:String,default:"标题"},width:{type:String,default:"30%"},dialogVisible:{type:Boolean,default:!1},isButtonGroupShow:{type:Boolean,default:!0}},methods:{handleClose:function(){this.$emit("handleClose")},close:function(){this.$emit("close")},save:function(){this.$emit("save")}}},a=n,l=i("2877"),r=Object(l["a"])(a,s,o,!1,null,"6ca987d4",null);e["a"]=r.exports},d729:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("breadcrumb",{attrs:{sperator:"/",breadcrumbItemList:["权限管理","角色列表"]}}),i("el-card",{attrs:{shadow:"always"}},[i("el-button",{attrs:{type:"primary"}},[t._v("添加角色")]),i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.rolesList,stripe:""}},[i("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.children,(function(s,o){return i("el-row",{key:s.id,class:["bdbottom",0==o?"bdtop":"","vcenter"]},[i("el-col",{attrs:{span:5}},[i("el-tag",{attrs:{closable:""},on:{close:function(i){return t.removeRoleById(e.row.id,s.id)}}},[t._v(" "+t._s(s.authName))]),i("i",{staticClass:"el-icon-caret-right"})],1),i("el-col",{attrs:{span:19}},t._l(s.children,(function(s,o){return i("el-row",{key:s.id,class:[0==o?"":"bdtop"]},[i("el-col",{attrs:{span:6}},[i("el-tag",{attrs:{type:"warning",closable:""},on:{close:function(i){return t.removeRoleById(e.row.id,s.id)}}},[t._v(t._s(s.authName))]),i("i",{staticClass:"el-icon-caret-right"})],1),i("el-col",{attrs:{span:18}},t._l(s.children,(function(s){return i("el-tag",{key:s.id,attrs:{type:"danger",closable:""},on:{close:function(i){return t.removeRoleById(e.row.id,s.id)}}},[t._v(t._s(s.authName))])})),1)],1)})),1)],1)}))}}])}),i("el-table-column",{attrs:{type:"index",label:"#"}}),i("el-table-column",{attrs:{prop:"roleName",label:"角色名称"}}),i("el-table-column",{attrs:{prop:"roleDesc",label:"角色描述"}}),i("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"}}),i("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"}}),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"设置",placement:"top",enterable:!1}},[i("el-button",{attrs:{type:"warning",icon:"el-icon-setting",size:"mini"},on:{click:function(i){return t.showDispatchDialog(e.row)}}})],1)]}}])})],1)],1),i("popup",{attrs:{title:"分配权限",dialogVisible:t.dispatchRightDialogVisible,width:"45%"},on:{handleClose:t.handleClosePopup,save:t.saveRoleRight}},[i("el-tree",{ref:"treeRef",attrs:{data:t.rightList,props:t.defaultProps,"show-checkbox":"","node-key":"id","default-expand-all":!0,"default-checked-keys":t.currentRightList}})],1)],1)},o=[],n=(i("99af"),i("4160"),i("a15b"),i("159b"),i("2909")),a=i("a049"),l=i("c22e"),r=i("1bab");function c(){return Object(r["a"])({url:"roles",method:"get"})}function u(t,e){return Object(r["a"])({url:"roles/".concat(t,"/rights/").concat(e),method:"delete"})}function d(t){return Object(r["a"])({url:"rights/".concat(t),method:"get"})}function h(t,e){return Object(r["a"])({url:"roles/".concat(t,"/rights"),method:"post",data:{roleId:t,rids:e}})}var f={name:"Role",data:function(){return{rolesList:[],deleteRoleQuery:{},dispatchRightDialogVisible:!1,rightList:[],defaultProps:{children:"children",label:"authName"},currentRightList:[],roleId:0}},created:function(){this.queryRole()},methods:{queryRole:function(){var t=this;c().then((function(e){200===e.meta.status?t.rolesList=e.data:t.$message.error(e.meta.msg)}))},removeRoleById:function(t,e){var i=this;this.$confirm("此操作将永久删除该权限, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.deleteRoleById(t,e)}))["catch"]((function(){}))},deleteRoleById:function(t,e){var i=this;u(t,e).then((function(t){200===t.meta.status?function(){i.queryRole(),i.$message.success(t.meta.msg)}():i.$message.error(t.meta.msg)}))},showDispatchDialog:function(t){this.roleId=t.id,this.queryRightList("tree"),this.dispatchRightDialogVisible=!0,this.getAllRightIdList(t,this.currentRightList)},getAllRightIdList:function(t,e){var i=this;if(!t.children)return e.push(t.id);t.children.forEach((function(t){return i.getAllRightIdList(t,e)}))},queryRightList:function(t){var e=this;d(t).then((function(t){200===t.meta.status?function(){e.rightList=t.data}():e.$message.error(t.meta.msg)}))},saveRoleRight:function(){var t=this;h(this.roleId,this.getCheckedString()).then((function(e){200===e.meta.status?function(){t.dispatchRightDialogVisible=!1,t.$message.success(e.meta.msg),t.queryRole()}():t.$message.error(e.meta.msg)}))},getCheckedString:function(){var t=[].concat(Object(n["a"])(this.$refs.treeRef.getCheckedKeys()),Object(n["a"])(this.$refs.treeRef.getHalfCheckedKeys()));return t.join(",")},closePopup:function(){this.dispatchRightDialogVisible=!1,this.currentRightList=[]},handleClosePopup:function(){this.dispatchRightDialogVisible=!1,this.currentRightList=[]}},components:{Breadcrumb:a["a"],Popup:l["a"]}},p=f,g=(i("2cb2"),i("2877")),m=Object(g["a"])(p,s,o,!1,null,"ddae7aec",null);e["default"]=m.exports}}]);
//# sourceMappingURL=chunk-d2db8980.1b9f31de.js.map